<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.4">Jekyll</generator><link href="https://lefevrej.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://lefevrej.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2024-12-22T17:58:56+00:00</updated><id>https://lefevrej.github.io/feed.xml</id><title type="html">blank</title><subtitle>Josselin Lefèvre&apos;s website. </subtitle><entry><title type="html">Getting started with pink</title><link href="https://lefevrej.github.io/blog/2024/pink-install/" rel="alternate" type="text/html" title="Getting started with pink"/><published>2024-01-22T00:00:00+00:00</published><updated>2024-01-22T00:00:00+00:00</updated><id>https://lefevrej.github.io/blog/2024/pink-install</id><content type="html" xml:base="https://lefevrej.github.io/blog/2024/pink-install/"><![CDATA[<h1 id="installing-and-setting-up-pink-library-on-linux">Installing and Setting up PINK Library on Linux</h1> <p>Welcome to the world of image processing with the PINK library! PINK is an open-source library designed for image analysis and processing tasks. In this brief tutorial, I’ll guide you through the process of downloading, installing, and setting up PINK on your Linux machine. We will also delve into some basic Linux commands to facilitate the installation process.</p> <p>The installation involves downloading the PINK library, performing the compilation in the local <code class="language-plaintext highlighter-rouge">/tmp</code> directory to optimize the process, and finally, setting up the necessary environment variables for seamless usage. By the end of this tutorial, you’ll have PINK installed and configured, ready to explore its capabilities.</p> <h2 id="1-download-pink-library-in-tmp">1. Download PINK Library in /tmp</h2> <p>In situations where the compilation of PINK might be time-consuming due to communication delays, it’s beneficial to perform the compilation in the local <code class="language-plaintext highlighter-rouge">/tmp</code> directory and then move the compiled files to the user’s working space. Navigate to the <code class="language-plaintext highlighter-rouge">/tmp</code> directory, where you will perform the compilation:</p> <ul> <li>Enter into the <code class="language-plaintext highlighter-rouge">/tmp</code> directory.</li> <li>Download PINK library at the following address: <a href="https://perso.esiee.fr/~coupriem/pink.tgz">https://perso.esiee.fr/~coupriem/pink.tgz</a>. It can be easily performed with the <code class="language-plaintext highlighter-rouge">wget</code> command.</li> </ul> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /tmp
wget https://perso.esiee.fr/~coupriem/pink.tgz
</code></pre></div></div> <h2 id="2-uncompress-pink">2. Uncompress PINK</h2> <ul> <li>Use the <code class="language-plaintext highlighter-rouge">tar</code> command to extract the contents of the <code class="language-plaintext highlighter-rouge">pink.tgz</code> file:</li> </ul> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">tar</span> <span class="nt">-xvzf</span> /tmp/pink.tgz
</code></pre></div></div> <h2 id="3-compile-pink">3. Compile PINK</h2> <ul> <li>Enter the extracted directory with <code class="language-plaintext highlighter-rouge">cd</code> and compile PINK using the provided <code class="language-plaintext highlighter-rouge">makelin</code> script.</li> </ul> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./makelin
</code></pre></div></div> <blockquote> <p>Don’t worry if there’s an error at the end of compilation. Doxygen is a documentation tool. PINK documentation can be found online: <a href="https://perso.esiee.fr/~coupriem/Pink/doc/html/">PINK documentation</a>.</p> </blockquote> <h2 id="4-move-pinktmp-to-your-working-space">4. Move PINKtmp to your Working Space</h2> <ul> <li>After the compilation is complete, move the compiled <code class="language-plaintext highlighter-rouge">PINKtmp</code> directory to your user’s working space. Replace <code class="language-plaintext highlighter-rouge">[user_working_space]</code> with the path to the user’s working directory:</li> </ul> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mv</span> /tmp/PINKtmp user_working_space
</code></pre></div></div> <h2 id="5-create--edit-pinkstart-file">5. Create &amp; edit .pink.start file</h2> <p>When a user types a command in the terminal, the system needs to locate the corresponding executable file to run that command. Instead of providing the full path to the executable every time, the <strong>PATH</strong> variable allows users to specify a set of directories where the system should search for executables.</p> <p><strong>An example.</strong> If the <strong>PATH</strong> variable is set as follows:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span>/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin
</code></pre></div></div> <p>And the user types <code class="language-plaintext highlighter-rouge">ls</code> in the terminal:</p> <ol> <li>The system looks for <code class="language-plaintext highlighter-rouge">ls</code> in <code class="language-plaintext highlighter-rouge">/usr/local/bin</code>. If found, it executes that version of ls.</li> <li>If not found, it looks in <code class="language-plaintext highlighter-rouge">/bin</code>.</li> <li>If still not found, it looks in <code class="language-plaintext highlighter-rouge">/usr/bin</code>.</li> <li>If the executable is found in any of these directories, the system executes the command. Otherwise, it displays an “command not found” error.</li> </ol> <p>You can display your PATH as follows:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="nv">$PATH</span>
</code></pre></div></div> <p>Our goal is to add the path to the PINK executable to the PATH so that you can run any PINK command from anywhere.</p> <ul> <li>Create and open the <code class="language-plaintext highlighter-rouge">.pink.start</code> file with a text editor (e.g., <code class="language-plaintext highlighter-rouge">nano</code> if you are blind, <code class="language-plaintext highlighter-rouge">vim</code> if you are brave, or <code class="language-plaintext highlighter-rouge">gedit</code> if you like user interfaces)</li> </ul> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">touch</span> ~/.pink.start
gedit ~/.pink.start &amp;
</code></pre></div></div> <ul> <li>Add the following two lines to the file, replacing <code class="language-plaintext highlighter-rouge">[user_working_space]</code> with the actual path to the user’s working space:</li> </ul> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">PINK</span><span class="o">=</span>user_working_space/Pinktmp
<span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:<span class="nv">$PINK</span>/linux/bin:<span class="nv">$PINK</span>/scripts:<span class="nv">$PINK</span>/tcl
</code></pre></div></div> <blockquote class="block-warning"> <h4 id="warning">WARNING</h4> <p>A file beginning with a dot (<code class="language-plaintext highlighter-rouge">.</code>) is considered a hidden file. As a result it may not show up in your explorer. To view hidden files in a Unix-like terminal, you can use the <code class="language-plaintext highlighter-rouge">-a</code> option with the <code class="language-plaintext highlighter-rouge">ls</code> command: <code class="language-plaintext highlighter-rouge">ls -a</code></p> </blockquote> <h2 id="6-source-pinkstart">6. Source .pink.start</h2> <p>Before using PINK in a new terminal session, run the following command to source the <code class="language-plaintext highlighter-rouge">.pink.start</code> file:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">source</span> ~/.pink.start
</code></pre></div></div> <p>Now, PINK is installed and configured on your Linux system. You can print your <strong>PATH</strong> variable to visualize the change. If you really want to be sure type <code class="language-plaintext highlighter-rouge">dilation</code>.</p>]]></content><author><name></name></author><category term="classes"/><category term="classes"/><summary type="html"><![CDATA[Efficiently pink install tutorial for linux newbies]]></summary></entry><entry><title type="html">Getting to grips with the watershed</title><link href="https://lefevrej.github.io/blog/2024/pink-watershed/" rel="alternate" type="text/html" title="Getting to grips with the watershed"/><published>2024-01-22T00:00:00+00:00</published><updated>2024-01-22T00:00:00+00:00</updated><id>https://lefevrej.github.io/blog/2024/pink-watershed</id><content type="html" xml:base="https://lefevrej.github.io/blog/2024/pink-watershed/"><![CDATA[<h2 id="problem-1-uranium-oxide">Problem 1 Uranium oxide</h2> <div class="row"> <div class="col-sm mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/uo-480.webp 480w,/assets/img/uo-800.webp 800w,/assets/img/uo-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/uo.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> <div class="col-sm mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/uo_surimp-480.webp 480w,/assets/img/uo_surimp-800.webp 800w,/assets/img/uo_surimp-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/uo_surimp.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <ol> <li>Segment all the cells of the attached uranium oxide image.</li> <li>Remove the cells that touch the frame of the image.</li> <li>Give some statistics about the cells (number, average size, etc.).</li> </ol> <h3 id="tools">Tools</h3> <table> <tbody> <tr> <td>- <a href="https://perso.esiee.fr/~coupriem/Pink/doc/html/pgm2GA_8c.html">pgm2GA</a></td> <td>- <a href="https://perso.esiee.fr/~coupriem/Pink/doc/html/GAwatershed_8c.html">GAwatershed</a></td> </tr> <tr> <td>- <a href="https://perso.esiee.fr/~coupriem/Pink/doc/html/GA2khalimsky_8c.html">GA2khalimsky</a></td> <td>- <a href="https://perso.esiee.fr/~coupriem/Pink/doc/html/frame_8c.html">frame</a></td> </tr> <tr> <td>- <a href="https://perso.esiee.fr/~coupriem/Pink/doc/html/nbcomp_8c.html">nbcomp</a></td> <td>- <a href="https://perso.esiee.fr/~coupriem/Pink/doc/html/area_8c.html">area</a></td> </tr> </tbody> </table> <blockquote> <p><strong>Hint</strong>: you can use the <a href="#how-to-watershed-with-pink">How to Watershed with PINK</a> section below to find some useful pink commands :wink:</p> </blockquote> <h2 id="problem-2-segmentation-of-red-blood-cells">Problem 2 Segmentation of red blood cells</h2> <style>.slider-example-focus{width:60%!important}@media(max-width:576px){.slider-example-focus{width:100%!important}}.slider-example-focus:focus{outline:0}.center-content{display:flex;justify-content:center;margin-bottom:1em}.no-margin,.no-margin *{margin:0!important}</style> <div class="center-content"> <img-comparison-slider class="slider-example-focus no-margin"> <figure slot="first"> <picture> <source class="responsive-img-srcset" srcset="/assets/img/bloodcells-480.webp 480w,/assets/img/bloodcells-800.webp 800w,/assets/img/bloodcells-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/bloodcells.png" class="img-fluid rounded z-depth-1 custom-image-size" width="100%" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <figure slot="second"> <picture> <source class="responsive-img-srcset" srcset="/assets/img/bloodcells_ws-480.webp 480w,/assets/img/bloodcells_ws-800.webp 800w,/assets/img/bloodcells_ws-1400.webp 1400w," sizes="95vw" type="image/webp"/> <img src="/assets/img/bloodcells_ws.png" class="img-fluid rounded z-depth-1 custom-image-size" width="100%" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </img-comparison-slider> </div> <ol> <li>Segment all the red blood cells in the attached bloodCells image.</li> <li>Remove the ones that touch the edge of the image.</li> <li>Separate the cells that are touching each other.</li> <li>Give some statistics about the globules (number, average size).</li> </ol> <blockquote> <p><strong>Hint</strong>: step 3 is tricky. It needs the notion of a <a href="#distance-map"><strong>distance map</strong></a> of a binary object.</p> </blockquote> <h2 id="how-to-watershed-with-pink">How to Watershed with PINK</h2> <h3 id="key-instructions">Key instructions</h3> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># To transform an image into a weighted edge graph:</span>
pgm2GA im.pgm 0 relief.ga
</code></pre></div></div> <blockquote class="block-tip"> <h5 id="tip">TIP</h5> <p>The second argument (here 0) indicates how we proceed to <strong>weight</strong> the edges (maximum / minimum or intensity difference between pixels at the ends of each edge).</p> <p><em>Is the choice of one weighting function more relevant than another? In which cases? What difference could it make to the output?</em></p> </blockquote> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># To calculate a Watershed Line of a weighted edge graph</span>
GAwatershed relief.ga watershed.ga

<span class="c"># To visualize the result, we switch to the Khalimsky grid</span>
GA2khalimsky watershed.ga 0 watershed.pgm
</code></pre></div></div> <blockquote class="block-tip"> <h5 id="tip-1">TIP</h5> <p>To superimpose a segmentation (in the form of a binary image) on a grayscale image, we can use <a href="https://perso.esiee.fr/~coupriem/Pink/doc/html/surimp_8c.html"><code class="language-plaintext highlighter-rouge">surimp</code></a> <strong>be careful the two images must be the same size</strong>.</p> </blockquote> <p>To resize an image to the desired size we can use zoom or make the image <code class="language-plaintext highlighter-rouge">img.pgm</code> undergo a transition to a weighted graph and then to the Khalimsky grid.</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pgm2GA img.pgm 0 img.ga
GA2khalimsky img.ga 0  imgRightSize.pgm
</code></pre></div></div> <h3 id="distance-map">Distance map</h3> <p>Basically, the distance map to a subset \(X\) of the space \(E\) is the image \(D_X\) on \(E\) defined, for every pixel \(x\) in \(E\) by \(D_X(x) = \min \{ \, d(x,y) \, | \, y \in X \, \}\) where \(d(x,y)\) denotes the (Euclidean) distance between \(x\) and \(y\).</p> <p>The the distance map to \(X\) is an image where the value of each pixel \(x\) is the distance from this point to the closest point which belongs to the set \(X\).</p> <p>To obtain the distance map of an object in Pink you can use the command <a href="https://perso.esiee.fr/~coupriem/Pink/doc/html/dist_8c.html"><code class="language-plaintext highlighter-rouge">dist</code></a> for example with the command:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dist X.pgm 1 distMapToX.pgm
</code></pre></div></div> <p>If needed you can convert the resulting image to a byte image (i.e., an image with values between 0 and 255) with the command:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>long2byte distMapToX.pgm  1 distMapToX_Byte.pgm
</code></pre></div></div> <blockquote class="block-warning"> <h5 id="warning">WARNING</h5> <p>If you calculate the map distance on an image that is too large, then the byte conversion will not work. The distances will be too large, resulting in an <a href="https://www.wikiwand.com/en/Integer_overflow">integer overflow</a>.</p> </blockquote> <h3 id="threshold-an-image-interactively">Threshold an image, interactively</h3> <p>Remind of the fantastic interactive <a href="https://perso.esiee.fr/~coupriem/Pink/doc/html/seuil_8tcl.html"><code class="language-plaintext highlighter-rouge">seuil.tcl</code></a>.</p> <h3 id="filter-an-image">Filter an image…</h3> <ul> <li>with an area closing: <a href="https://perso.esiee.fr/~coupriem/Pink/doc/html/areaclosing_8c.html"><code class="language-plaintext highlighter-rouge">areaclosing</code></a></li> <li>with a dynamic closing (depth): <a href="https://perso.esiee.fr/~coupriem/Pink/doc/html/heightminima_8c.html"><code class="language-plaintext highlighter-rouge">heightminima</code></a></li> <li>with a volume closing: <a href="https://perso.esiee.fr/~coupriem/Pink/doc/html/volmaxima_8c.html"><code class="language-plaintext highlighter-rouge">volmaxima</code></a> and <a href="https://perso.esiee.fr/~coupriem/Pink/doc/html/inverse_8c.html"><code class="language-plaintext highlighter-rouge">inverse</code></a></li> </ul> <h3 id="compute-statistics">Compute statistics</h3> <ul> <li>To count the number of white pixels in a binary image: <a href="https://perso.esiee.fr/~coupriem/Pink/doc/html/area_8c.html"><code class="language-plaintext highlighter-rouge">area</code></a></li> <li>To count the number of connected components in a binary image: <a href="https://perso.esiee.fr/~coupriem/Pink/doc/html/nbcomp_8c.html"><code class="language-plaintext highlighter-rouge">nbcomp</code></a></li> </ul> <h3 id="to-obtain-a-black-image-with-a-white-border">To obtain a black image with a white border</h3> <p>Try <a href="https://perso.esiee.fr/~coupriem/Pink/doc/html/frame_8c.html"><code class="language-plaintext highlighter-rouge">frame</code></a>.</p>]]></content><author><name>Jean Cousty</name></author><category term="classes"/><category term="classes"/><summary type="html"><![CDATA[Learn how to performs basic watershed segmentation with Pink]]></summary></entry></feed>